
function updateProgress(pct){ document.getElementById('progress-bar').style.width = pct + '%'; }
function step1(){const d=document.getElementById('datepicker').value;const f=document.getElementById('folderInput').files;if(!d||f.length===0){alert('Please select date and folder');return;}document.getElementById('step1-status').innerText='Folder copied (simulated).';updateProgress(20);document.getElementById('btn-step2').classList.remove('disabled');}
function step2(){const file=document.getElementById('excelInput').files[0];if(!file){alert('Select Excel');return;}const r=new FileReader();r.onload=e=>{const wb=XLSX.read(e.target.result,{type:'binary'});document.getElementById('step2-status').innerText='Excel loaded: '+wb.SheetNames[0];updateProgress(40);document.getElementById('btn-step3').classList.remove('disabled');};r.readAsBinaryString(file);} 
function step3(){const A=document.getElementById('fileA').files[0];const B=document.getElementById('fileB').files[0];if(!A||!B){alert('Select both files');return;}document.getElementById('step3-status').innerText='Delta calculated.';updateProgress(60);document.getElementById('btn-step4').classList.remove('disabled');} 
function step4(){document.getElementById('step4-status').innerText='Report generated.';updateProgress(80);document.getElementById('btn-post1').classList.remove('disabled');document.getElementById('btn-post2').classList.remove('disabled');} 
async function postToTeams(area){const url='https://your-teams-webhook-url';await fetch(url,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({text:`Posted to ${area}`})});updateProgress(100);document.getElementById('teams-status').innerText='Posted to '+area;} 
